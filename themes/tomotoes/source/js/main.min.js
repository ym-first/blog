!function(t,e){const i=e.body,s=e.querySelector.bind(e),n=e.querySelectorAll.bind(e),o=s("html"),a=s("#gotop"),c=s("#menu"),l=s("#main"),r=s("#header"),d=s("#mask"),h=s("#menu-toggle"),u=s("#menu-off"),f=s(".header-title"),m=s("#loading"),g=-1!==location.href.indexOf("post"),p=t.requestAnimationFrame,v=Array.prototype.forEach,L=/micromessenger/i.test(navigator.userAgent),w=function(){},y=function(t){let e=t.offsetLeft,i=t.offsetTop;if(t.offsetParent){const s=arguments.callee(t.offsetParent);e+=s.x,i+=s.y}return{x:e,y:i}};let $="ontouchstart"in t&&/Mobile|Android|iOS|iPhone|iPad|iPod|Windows Phone|KFAPWI/i.test(navigator.userAgent)?"touchstart":"click",E=e.documentElement;t.innerWidth>600?(window.navigator.userAgent.indexOf("WOW")>-1||window.navigator.userAgent.indexOf("Edge")>-1||window.navigator.userAgent.indexOf("MSIE")>-1)&&-1===window.navigator.userAgent.indexOf("Trident")&&(E=i):window.navigator.userAgent.indexOf("Android")>-1&&window.navigator.userAgent.indexOf("Browser")>-1&&(E=i);const x={goTop:function(t){const e=E.scrollTop,i=arguments.length>2?arguments[1]:Math.abs(e-t)/12;e&&e>t?(E.scrollTop=Math.max(e-i,0),p(arguments.callee.bind(this,t,i))):t&&e<t?(E.scrollTop=Math.min(e+i,t),p(arguments.callee.bind(this,t,i))):this.toc.actived(t)},toggleGotop:function(e){e>t.innerHeight/2?a.classList.add("in"):a.classList.remove("in")},toggleMenu:function(e){if(e){if(c.classList.remove("hide"),g||(l.classList.remove("menuoff"),jQuery(f).animate({marginRight:"15%"})),t.innerWidth<1241)if(d.classList.add("in"),c.classList.add("show"),L){const t=E.scrollTop;l.classList.add("lock"),l.scrollTop=t}else o.classList.add("lock")}else if(d.classList.remove("in"),c.classList.remove("show"),L){const t=l.scrollTop;l.classList.remove("lock"),E.scrollTop=t}else o.classList.remove("lock")},fixedHeader:function(t){t>r.clientHeight?r.classList.add("fixed"):r.classList.remove("fixed")},toc:function(){const t=s("#post-toc");if(!t||!t.children.length)return g&&l.classList.add("show"),{fixed:w,actived:w};const e=s(".post-header").clientHeight,i=r.clientHeight,n=s("#post-content").querySelectorAll("h1, h2, h3, h4, h5, h6");return t.querySelector(`a[href="#${n[0].id}"]`).parentNode.classList.add("active"),l.classList.add("tocshow"),f.classList.add("toc"),s(".footer").classList.add("toc"),{fixed:function(s){s>=e-i?t.classList.add("fixed"):t.classList.remove("fixed")},actived:function(e){for(let s=0,o=n.length;s<o;s++)if(e>y(n[s]).y-i-5){t.querySelector("li.active").classList.remove("active");t.querySelector(`a[href="#${n[s].id}"]`).parentNode.classList.add("active")}e<y(n[0]).y&&(t.querySelector("li.active").classList.remove("active"),t.querySelector(`a[href="#${n[0].id}"]`).parentNode.classList.add("active"))}}}(),hideOnMask:[],modal:function(i){this.$modal=s(i),this.$off=this.$modal.querySelector(".close");const n=this;this.show=function(){d.classList.add("in"),t.innerWidth>800&&(l.classList.add("Mask"),c.classList.add("Mask")),n.$modal.classList.add("ready"),setTimeout((function(){n.$modal.classList.add("in")}),0)},this.onHide=w,this.hide=function(){if(n.onHide(),d.classList.remove("in"),t.innerWidth>800){l.classList.remove("Mask"),c.classList.remove("Mask");const t=e.querySelector(".imgShow");t&&document.body.removeChild(t)}n.$modal.classList.remove("in"),setTimeout((function(){n.$modal.classList.remove("ready")}),300)},this.toggle=function(){return n.$modal.classList.contains("in")?n.hide():n.show()},x.hideOnMask.push(this.hide),this.$off&&this.$off.addEventListener($,this.hide)},share:function(){const t=s("#pageShare"),i=s("#shareFab"),o=new this.modal("#globalShare");i&&(i.addEventListener($,(function(){t.classList.toggle("in")}),!1),e.addEventListener($,(function(e){i.contains(e.target)||t.classList.remove("in")}),!1));const a=new this.modal("#wxShare");a.onHide=o.hide,v.call(n(".wxFab"),(function(t){t.addEventListener($,a.toggle)}))},reward:function(){const t=new this.modal("#reward"),e=s("#rewardCode"),i=s("#rewardToggle");let n=!1,o=-1;const a=s(".wechatPay"),c=s(".alipayPay"),l=s(".icon-caret-up");s("#rewardBtn").addEventListener($,(function(){-1===o?e.src=e.dataset.img:1===o?e.src=i.dataset.alipay:0===o&&(e.src=i.dataset.wechat),t.toggle()})),a.addEventListener("click",(function(){n=!0})),i&&i.addEventListener("change",(function(){this.checked?n?(e.src=this.dataset.wechat,c.classList.remove("show"),a.classList.add("show"),l.style="margin-left:-20%;",o=0):(e.src=this.dataset.alipay,c.classList.add("show"),a.classList.remove("show"),l.style="margin-left:20%;",this.checked=!1,o=1):(e.src=this.dataset.alipay,c.classList.add("show"),a.classList.remove("show"),l.style="margin-left:20%;",o=1)}))},tabBar:function(t){t.parentNode.parentNode.classList.toggle("expand")},page:function(){const t=n(".fade, .fade-scale");let e=!1;return{loaded:function(){v.call(t,(function(t){t.classList.add("in")})),e=!0},unload:function(){v.call(t,(function(t){t.classList.remove("in")})),e=!1},visible:e}}(),lightbox:function(){function s(s){let n,o,a,c,l;this.$img=s.querySelector("img"),this.$overlay=s.querySelector("overlay"),this.margin=40,this.title=this.$img.title||this.$img.alt||"",this.isZoom=!1,this.calcRect=function(){c=i.clientWidth,l=i.clientHeight;const t=l-2*this.margin;let e=n,s=o;this.margin;const r=e>c?c/e:1,d=s>t?t/s:1,h=Math.min(r,d);return e*=h,s*=h,{w:e,h:s,t:(l-s)/2-a.top,l:(c-e)/2-a.left+this.$img.offsetLeft}},this.setImgRect=function(t){this.$img.style.cssText=`width: ${t.w}px; max-width: ${t.w}px; height:${t.h}px; top: ${t.t}px; left: ${t.l}px`},this.setFrom=function(){this.setImgRect({w:a.width,h:a.height,t:0,l:(s.offsetWidth-a.width)/2})},this.setTo=function(){this.setImgRect(this.calcRect())},this.addTitle=function(){this.title&&(this.$caption=e.createElement("div"),this.$caption.innerHTML=this.title,this.$caption.className="overlay-title",s.appendChild(this.$caption))},this.removeTitle=function(){this.$caption&&s.removeChild(this.$caption)};const r=this;this.zoomIn=function(){n=this.$img.naturalWidth||this.$img.width,o=this.$img.naturalHeight||this.$img.height,a=this.$img.getBoundingClientRect(),s.style.height=`${a.height}px`,s.classList.add("ready"),this.setFrom(),this.addTitle(),this.$img.classList.add("zoom-in"),setTimeout((function(){s.classList.add("active"),r.setTo(),r.isZoom=!0}),0)},this.zoomOut=function(){this.isZoom=!1,s.classList.remove("active"),this.$img.classList.add("zoom-in"),this.setFrom(),setTimeout((function(){r.$img.classList.remove("zoom-in"),r.$img.style.cssText="",r.removeTitle(),s.classList.remove("ready"),s.removeAttribute("style")}),300)},s.addEventListener("click",(function(t){r.isZoom?r.zoomOut():"IMG"===t.target.tagName&&r.zoomIn()})),e.addEventListener("scroll",(function(){r.isZoom&&r.zoomOut()})),t.addEventListener("resize",(function(){r.isZoom&&r.zoomOut()}))}v.call(n(".img-lightbox"),(function(t){new s(t)}))}(),loadScript:function(t){t.forEach((function(t){const s=e.createElement("script");s.src=t,s.async=!0,i.appendChild(s)}))}};t.addEventListener("load",(function(){m.classList.remove("active"),x.page.loaded(),t.lazyScripts&&t.lazyScripts.length&&x.loadScript(t.lazyScripts)})),t.addEventListener("DOMContentLoaded",(function(){const t=E.scrollTop;x.toc.fixed(t),x.toc.actived(t),x.page.loaded()}));let T=!1;const O=s('a[href^="mailto"]');O&&O.addEventListener($,(function(){T=!0})),t.addEventListener("beforeunload",(function(){T?T=!1:x.page.unload()})),t.addEventListener("pageshow",(function(){x.page.visible||x.page.loaded()})),t.addEventListener("resize",(function(){$="ontouchstart"in t?"touchstart":"click",t.BLOG.even=$,x.toggleMenu()})),a.addEventListener($,(function(){p(x.goTop.bind(x,0))}),!1),h.addEventListener($,(function(t){x.toggleMenu(!0),t.preventDefault()}),!1),u.addEventListener($,(function(){c.classList.add("hide"),g||(l.classList.add("menuoff"),jQuery(f).animate({marginRight:"15%"}))}),!1),d.addEventListener($,(function(t){x.toggleMenu(),x.hideOnMask.forEach((function(t){t()})),t.preventDefault()}),!1),e.addEventListener("scroll",(function(){const t=E.scrollTop;x.toggleGotop(t),x.fixedHeader(t),x.toc.fixed(t),x.toc.actived(t)}),!1),t.BLOG.SHARE&&g&&x.share(),t.BLOG.REWARD&&x.reward(),x.noop=w,x.even=$,x.$=s,x.$$=n,Object.keys(x).reduce((function(t,e){return t[e]=x[e],t}),t.BLOG),t.Waves?(Waves.init(),Waves.attach(".global-share li",["waves-block"]),Waves.attach(".article-tag-list-link, #page-nav a, #page-nav span",["waves-button"])):console.error("Waves loading failed.")}(window,document),function(){const t=window||this,e=t.BLOG.even,i=t.BLOG.$,s=i("#search"),n=i("#search-wrap"),o=i("#key"),a=i("#back"),c=i("#search-panel"),l=i("#search-result"),r=i("#search-tpl").innerHTML,d=`${t.BLOG.ROOT}/content.json`.replace(/\/{2}/g,"/");let h;const u=i("html"),f=function(){t.innerWidth<760&&u.classList.add("lock-size"),c.classList.add("in")},m=function(){t.innerWidth<760&&u.classList.remove("lock-size"),c.classList.remove("in")};function g(t,e){return e.lastIndex=0,e.test(t)}function p(e){const i=this.value.trim();if(!i)return;nkey=i.replace(/[(]/g,"\\(").replace(/[)]/g,"\\)");const s=new RegExp(nkey.replace(/[ ]/g,"|"),"gmi");!function(t){if(h)t(h);else{const e=new XMLHttpRequest;e.open("GET",d,!0),e.onload=function(){if(this.status>=200&&this.status<300){const e=JSON.parse(this.response);h=e instanceof Array?e:e.posts,t(h)}else console.error(this.statusText)},e.onerror=function(){console.error(this.statusText)},e.send()}}((function(e){!function(e){let i="";i=e.length?e.map((function(e){return function(t,e){return t.replace(/\{\w+\}/g,(function(t){const i=t.replace(/\{|\}/g,"");return e[i]||""}))}(r,{title:e.title,path:`${t.BLOG.ROOT}/${e.path}`.replace(/\/{2,}/g,"/"),date:new Date(e.date).toLocaleDateString(),tags:e.tags.map((function(t){return`<span>#${t.name}</span>`})).join("")})})).join(""):'<li class="tips"><i class="icon icon-coffee icon-3x"></i><p>Results not found!</p></li>',l.innerHTML=i}(e.filter((function(t){return function(t,e){return g(t.title,e)||t.tags.some((function(t){return g(t.name,e)}))||g(t.text,e)}(t,s)}))),f()})),e.preventDefault()}s.addEventListener(e,(function(){n.classList.toggle("in"),o.value="",n.classList.contains("in")?o.focus():o.blur()})),a.addEventListener(e,(function(){n.classList.remove("in"),m()})),document.addEventListener(e,(function(t){"key"!==t.target.id&&"click"===e&&m()})),o.addEventListener("input",p),o.addEventListener(e,p);var v=document.getElementsByClassName("nav")[0],L=document.createElement("link");L.rel="stylesheet",L.href="/blog/dist/APlayer.min.css",v.appendChild(L);var w=document.createElement("div");w.id="aplayer",v.appendChild(w);var y=document.createElement("script");y.type="text/javascript",y.src="/blog/dist/APlayer.min.js",v.appendChild(y),window.onload=function(){var t=document.createElement("script");t.type="text/javascript",t.src="/blog/dist/music.js",v.appendChild(t)}}.call(this);
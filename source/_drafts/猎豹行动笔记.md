---
title: 猎豹行动笔记
tags:
  - 读书笔记
  - 敏捷
  - DevOps
categories: 读书笔记
abbrlink: 5e8f1732
date: 2020-04-20 10:10:11
---
## 前言
去年为了了解敏捷开发流程和DevOps, 也看了《猎豹行动》这本书. 同样按照, 故事脉络、有趣段落摘抄、相关概念、个人感悟这几个模块来整理笔记.

## 故事脉络
<!-- more -->
## 相关概念
### 敏捷
#### 方法论
##### Scrum
* 有专属团队的纯开发项目，需要稳定的交付节奏的项目，适用Scrum。需要跨项目、跨团队合作的，一人分饰多角的，维护类型的项目，适用看板
* 相关概念
    * Product Owner（PO），用户/客户/业务代言人，即可以做出业务决策（需求和优先级）的人
    * Scrum Master，熟悉Scrum流程的人，指导和确保团队以Scrum的方式进行交付
    * Sprint，对迭代的说法。一个项目或产品的交付就是由一个又一个的Sprint构成的
    * User Story，用户故事。具有业务价值的交付单位，一个项目或产品由很多用户故事构成
    * Product Backlog，可理解为项目的代办列表，由用户故事构成
    * Sprint Backlog，一个Sprint的代办列表，确定Sprint里有哪些用户故事，框定Sprint的开发范围
* 过程
    * 每个项目或产品的交付由若干个Sprint构成。Sprint的周期是固定的，以保持节奏。通常是2-4个星期，不建议超过4个星期
    每个Sprint开始时，PO和IT团队一起开Sprint计划会议，PO对Product Backlog中的用户故事进行排序，选出最重要的用户故事——》IT团队对这些用户故事进行估算。Sprint的周期和团队成员数量的确定，也确定了团队的大概交付能力——》确定哪些用户故事会放到这个Sprint的Backlog里，作为Sprint的开发范围——》围绕用户故事开发，每天一次站会，汇报昨天做了什么，今天会做什么，昨天遇到什么问题——》Sprint结束的时候，开评审会议，展示交付，PO的反馈，包括需求变更都可定义成新的用户故事放到Product Backlog里重新排队
    * 敏捷的所有改变都是为了快速反馈
        * 短迭代开发，让PO更快、更早地看到成品，给予反馈
        * 每日站会，每天都能看到进度和阻碍
        * 回顾会议，每个迭代都反思改进点，形成持续改善的机制
##### 极限编程
* 12个实践
    * 确保开发可更早开始和迭代式的持续交付
        * 计划游戏，planning game，把整个项目拆分成从几天到几个星期的若干个迭代，把需求拆分成一个独立的用户故事，放在Backlog里——》每个迭代开始时，用户对用户故事进行排序——》通过估算确定哪些用户故事可在整个迭代里开发。且只对当前迭代进行计划，新需求产生的用户故事要放到后面的迭代中
        * 小型发布，small release，每个迭代后，所开发的用户故事都可发布或展示给用户，获取反馈，新的用户故事放到后面的迭代中
    * 确保客户和交付团队都明白在做什么
        * 现场客户，onsite customer，用户应该和交付团队始终在一起，持续参与到项目中，阐明用户故事的具体需求和用户故事优先级，给交付团队及时的反馈
        * 系统隐喻，system metaphor，记录用户故事需求时，用交付团队和客户都能理解的语言编写
    * 测试驱动开发，test driven development，在编程前就根据用户故事的需求写好测试（自动化测试），通过测试来验证编程代码是否满足需求。
    * 持续集成，continuous integration，每天或每次有代码提交时就集成一次（编译、运行所有自动化测试、打包）
    * 重构，refactoring，不改变功能和外部行为而优化代码的可读性、质量、性能，有了自动化测试和持续集成，可保证重构后出现测试失败，立即回滚代码
    * 代码集体所有权，collective code ownership，在自动化测试和持续集成的保障下，任何人都可以对代码重构
    * 简单设计，simple design，只为当前要做的需求进行最简单的设计
    * 结对编程，pair Programming，两个人结对在同一台计算机前来完成编程，一次性完成编程与评审
    * 每周只工作40个小时，40-hour week
    * 编码规范，code standards，有一套整个团队都认可的规范
* 5个核心价值
    * 沟通，communication、简单，simplicity、反馈，feedback、勇气，courage、谦逊modesty
##### 看板（另外一种敏捷、精益的方法）
* 原则
    * 进度可视化
        * 识别整个交付从左到右的各道工序哪里是瓶颈
        * 根据约束理论，一切瓶颈以外的改善都是徒劳的. 约束理论Theory of Constraint，TOC，帮助企业识别出在实现目标的过程中存在着哪些制约因素，并进一步指出如何实施必要的改进措施
    * 限制在制品（WIP，Work-in-progress）
        * 一个请求，只有所有工序都完成并交付到客户那里，其价值才能得到体现。
        * 大量在制品堆积会导致优先级迷失和任务切换，任务切换又会导致效率低下，降低交付速度。
        * 只有下游有闲置产能才从上游拉入新的请求，避免在制品堆积
        * Scrum限制在制品的方式是通过Sprint计划会议限制每个Sprint放入的用户故事
        * 看板则是在每道交付工序中限制并行任务数量
    * 观察和改善流动
* 与Scrum相通的地方
    * 都基于敏捷与精益的原则，追求价值，消除浪费
    * 都是基于拉动的计划系统
    * 都限制在制品
    * 都通过透明化来获取快速反馈
    * 都聚焦于更早和更频繁地交付软件
    * 都需要把大需求拆分成小故事
* 可利用JIRA，按需定义看板的范围、外观、限制在制品数量、泳道、卡片的外观等。每天对着JIRA看板来开每日例会，业务也可通过看板的情况来判断团队分配是否合理，及整个交付过程的瓶颈在哪
累积流图，一个面积图，强调用户故事或是需求数随时间而变化的程度，直观显示整体趋势走向。x时间，y需求数量。
* 观察看板时，要关注的是有没有空闲的任务，而不是有没有空闲的人员

* 变革需要整个公司文化和价值观上的改变与配合及人力、工具的投入，只有管理层的支持才能使变革遍地开花

* 瀑布模型开发
* 痛点
    * 业务部门
        * 预期交付
        * 超支
        * 看到成品时项目已接近尾声
        * 缺乏透明度，不知道具体进度
        * 很难变更需求
        * 最终发现开发出来的产品不是他们想要的
        * 殆误战机，丢失市场机会
    * IT部门
        * 过度承诺
        * 难以一次性消化所有需求
        * 惧怕需求变更
        * 不断重做
        * 后期压力巨大
        * 加班
* 导致痛点的原因
    * 只有预算和目标交付时间是确定的
    * 不确定因素
        * 范围和具体需求
        * 可能的需求变更
        * 人员（放假离职）
        * 估算的准确性
        * 对现有系统的影响
        * 服务器环境的搭建
* 存在的问题
    * 需求分析花的时间多，开发时间被压缩
    * 变更成本高
    * 业务要在用户验收测试阶段才能看到成品，临近目标交付日期
* 真正的敏捷开发必须是基于用户故事的开发过程
* 如按报表来拆成若干个用户故事，选最常用的报表（对业务有价值的最小单位）先开发给业务测试，为其他用户故事打下基础，通过早交付、早测试、早验收把产品的方向确定。
    * 如果只是按功能点拆分，单个功能点的完成没有什么业务价值，无法测试
* 用户故事地图
    * 从左到右按时间顺序罗列用户行为（流程的每一步）——》在每个用户行为从上至下地罗列相应的细节（包括所需的开发点）。基于这张地图，还可对每个开发点的业务价值进行审视，找出最小可用产品（MVP，Minimal Viable Product）并制订发布计划
    ![](https://tva1.sinaimg.cn/large/007S8ZIlly1ge0103m24lj30wi0m27eb.jpg)
    * 记录家里所有物品的APP，每购入新物品就记录
        * 用户故事地图
        ![](https://tva1.sinaimg.cn/large/007S8ZIlly1ge011rwdwlj30nc092q6m.jpg)
        * 回顾地图，梳理每个用户故事的优先级，设想如果我们要在一周内做出MVP，会做哪些用户故事
        ![](https://tva1.sinaimg.cn/large/007S8ZIlly1ge0125wyyuj30n809eacx.jpg)
        * 开发一个功能所需要的时间与成本总是超出预期的
        * 需求是需要验证的假设，通过MVP可以快速试验，通过最小成本验证需求假设是否成立
        * MVP是从整个业务角度来找出一个既能实现相同业务目标、IT成本最小的方法来快速启动新业务
            * 如，要开一家提供网上订餐外送服务的餐厅，半个月内做出一个静态网站，展示菜式和订餐热线，生意就可在半个月之内运作起来。审视的是整个商业模式，不光是IT功能，更重要的是这样的外送服务模式是否可行和菜品是否受欢迎
* 3C原则
    * Card（地图）
    * Conversation，确定发布计划后，要和PO围绕当前发布计划中的每一张Card聊具体需求
    * Confirmation，确定验收条件
* 制定发布计划时，遵循刚刚好good enough、更好better、最好best的演进原则
* 敏捷落地比较图
![](https://tva1.sinaimg.cn/large/007S8ZIlly1ge013ieznhj30ua0iy0yo.jpg)

* 实践经验
* IT人员与提需求的业务人员直接沟通。（以前老大也经常这么说，产品提的需求只是个解决方案，还需要跟业务沟通，把握真正的需求）
* 交付文档模版
* 需求描述
* 作为（谁），我想要（做什么），为了（为什么）。如Gherkin的given when then的语言格式，使业务部门和IT部门双方都能看懂的统一语言
* 自动化测试框架cucumber，一个用普通语言描述测试用例的、支持行为驱动开发BDD的自动化工具，由Ruby编写，支持Java、.NET等多种开发语言。业务人员确定了对系统的期望行为，再通过代码执行实例，实现验收测试自动化，并纳入持续集成
* 确认理解
* 复述对需求的理解
* 问为什么
* 在什么场景下需要这个需求，包括谁用、什么时候用和使用条件、要解决什么问题、使用频次、怎么发生等（挖掘真实用意，因为有些需求是解决方案）
* 验收条件
* 以终为始，一开始明确要做成什么样，指导行动并确保结果正确。包括happy path和exceptional scenario
* 详细设计与实现
* 集成测试结果
* 用户验收测试
* 上线备忘
    * 上线所需要的额外步骤
* 优先级统一
* 延迟成本，cost of delay，计算每个请求如果逾期的话造成的损失，将其折算成金钱，来量化所有请求的优先级
* 服务等级，class of service，对于不同的请求类型，赋予不同的服务等级，区别处理
    * 加急类(Expedite), 常见于一些时效性特别强的需求, 或者对产品重大缺陷的修复. 这一类请求将被视为最高优先级, 可以无视最大在制品(WIP)的限制而直接进行作业. 然而这样的请求, 很容易对看板的正常工作造成冲击, 因此加急类的任务个数, 通常仅设置为1.
    * 固定交付日期类(Fixed Delivery Date), 推荐安排一定的产能来处理一些固定交付日期的请求. 对于这一类请求, 需要交付团队在开发之前对请求的工作量进行估算, 并在开发过程中定期地确认进度. 一旦发现进度落后到有可能无法完成的地步, 则需要交付团队对请求重新进行评估. 如有必要, 这类请求可以升级为加急类.
    * 标准类(Standard), 最普通的请求. 推荐大部分的产能都归类到此类请求. 交付团队无需对请求的工作量进行估算, 直接按照先进先出的顺序进行处理即可. 但对于超过两周工作量的请求, 建议先进行拆分.
    * 无形类(Intangible), 主要针对一些用户价值有限的附加功能, 推荐安排此类任务上的产能应该低于标准类的产能.

* 关键链
    * 决定项目长度的全部关键因素的关键路径和其他一些需要关键资源的任务。把关键链上所有任务被扣除的安全时间放在最后要给任务后作为项目缓冲，保护项目不受关键链任务延迟的影响。所有非关键路径上的任务被扣减的安全时间也集中在一起作为接入关键链的接驳缓冲，保护关键链不受这些任务延迟的影响
    ![](https://tva1.sinaimg.cn/large/007S8ZIlly1ge01fmm6trj31cy0kqk7v.jpg)
    * 约束理论五步法
        * 定义系统限制（瓶颈）
        * 决定如何充分利用限制
        * 让非限制资源充分配合
        * 打破系统限制
        * 若限制已打破，回到步骤一
* DevOps，实现开发与运维一体化和端到端的持续交付，融合了敏捷与精益的精神

* 工具
    * JIRA，项目与事务跟踪工具，被广泛应用于缺陷跟踪、客户服务、需求收集、流程审批、任务跟踪、敏捷管理等
    * Confluence，用于企业知识管理与协同，及构建企业wiki
    * GitHub，基于Git工具的在线代码托管平台，分布式的代码管理工具，程序员可以通过Git在本地管理自己的分支，在成熟的时机把分支推到评审才能完成，从而强化代码评审的过程
    * Nexus，公司自建Nexus仓库缓存和管理代码库可大大提高下载和管理的效率
    * Maven2，一个在Java开发中被广泛使用的项目管理工具，包含项目代码结构管理、项目生命周期及依赖管理系统，富含各种插件满足各种开发、测试、发布的需要
    * Jenkins，持续集成工具，可灵活定义各种自动化的job来完成特定的集成工序，包括定时触发或代码提交时触发。
        * 监测代码库（GitHub）的提交行为，一旦提交完成，自动执行集成，从代码库获取所有代码，执行设定的Maven Goal（编译、测试、打包、发布到Nexus）并输出测试结构。
    * SonarQube，其插件可涵盖静态代码分析、自动化测试覆盖率等指标，告之团队的代码质量目标。Jenkins的job可嵌入SonarQube检查
    * Ansible，自动化部署工具，通过编写Play Book来执行部署
* 思维
    * 零缺陷和零风险是不可实现的，很多问题只有在生产环境才会出现，如果敏捷和DevOps做得好，做到真正的持续交付、频繁上线，每次上线所涉及的变更范围缩到最小
    * 真正的持续交付需要从左端的业务需求到右端的上线全流程配合
## 个人感悟
